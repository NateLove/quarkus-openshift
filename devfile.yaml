schemaVersion: 2.2.0
metadata:
  name: quarkus-openshift

projects:
  - name: quarkus-openshift
    git:
      remotes:
        origin: https://github.com/NateLove/quarkus-openshift.git
      checkoutFrom:
        revision: main

components:
  - name: tools
    container:
      image: quay.io/devspaces/udi-rhel9:latest
      memoryLimit: 4Gi
      mountSources: true
      env:
        - name: MAVEN_OPTS
          value: "-Xmx1024m"
      endpoints:
        - name: quarkus-dev
          targetPort: 8080
          exposure: public
          protocol: http

commands:
  - id: mvn-package
    exec:
      component: tools
      workingDir: /projects/quarkus-openshift
      commandLine: ./mvnw -DskipTests package

  - id: quarkus-dev
    exec:
      component: tools
      workingDir: /projects/quarkus-openshift
      commandLine: ./mvnw quarkus:dev -Dquarkus.http.host=0.0.0.0

  - id: run-jar
    exec:
      component: tools
      workingDir: /projects/quarkus-openshift
      commandLine: java -jar target/quarkus-app/quarkus-run.jar
